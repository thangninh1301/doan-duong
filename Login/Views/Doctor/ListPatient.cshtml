@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration
<script>
    const backendUrl = "https://backend-btl.mooo.com";
</script>
@{
    ViewData["Title"] = "Home Page";
}
@using Microsoft.AspNetCore.Identity
@using BackEnd.Models
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
<div class="">
    <input type="text" id="myInput" placeholder="Tìm Kiếm" />
    <button class="btn-group-circle btn btn-primary" id="btnSearch" data-bind="click: $root.search">Tìm kiếm</button>
    <button class="btn-group-circle btn btn-primary" id="btnSearch" data-bind="click: $root.click">Tất Cả</button>
</div>
<div class="text-center">
    @if (SignInManager.IsSignedIn(User))
    {

        <input hidden type="text" id="doctor" value=@UserManager.GetUserAsync(User).Result.Id>

        <div>
            <h2>Bác Sỹ Khám:  Danh sách bệnh nhân</h2>

            <table class="table">
                <tr>
                    <td>ID</td>
                    <td>Ho</td>
                    <td>Bệnh nhân</td>
                    <td> SDT</td>
                    <td></td>
                </tr>
                <tbody id="search_table" data-bind="foreach:$root.arrays">
                    <tr>
                        <td data-bind="text:patient"></td>
                        <td data-bind="text:firstName"></td>
                        <td data-bind="text:lastName"></td>
                        <td data-bind="text:userNumber"></td>
                        <td>

                            <button type="button" class="btn btn-primary" data-toggle="modal" data-bind="click: $root.detail">Lịch sử khám</button>

                        </td>
                    </tr>
                </tbody>
            </table>
        </div>




        <div id="list" class="modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content" style="width:700px">
                    <div class="modal-header">
                        <h5 class="modal-title">Thông tin khám bệnh</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div style="background-color:cornflowerblue">
                            <h2>Bệnh nhân:</h2>
                            <p id="name"></p>
                        </div>
                        <div class="mb-3">

                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Mã phiếu hẹn</th>

                                        <th>Triệu chứng</th>
                                        <th>Ngày đến khám</th>
                                        @* <th>Thời gian khám</th>*@
                                        <th>Trạng thái</th>


                                        <td></td>
                                    </tr>
                                </thead>
                                <tbody id="search_table" data-bind="foreach:$root.arrays2">
                                    <tr data-bind="style:{color: apointmentTicket.status < 2 ? 'red' : 'green'}">
                                        <td data-bind="text:apointmentTicket.id"></td>

                                        <td data-bind="text:symptom"></td>
                                        <td data-bind="text:dateMeet"></td>
                                        @*  <td data-bind="text:apointmentTicket"></td>*@
                                        <td data-bind="text:apointmentTicket.status > 1 ? 'Đã có kết quả': 'Chưa có kết quả'"></td>
                                        <td>
                                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg" data-bind="click: $root.showResult">Xem</button>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="showresult" class="modal" tabindex="-1">
            <div class="modal-dialog" style="width:100%;height:100vh">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Phiếu kết quả khám bệnh</h3>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div style="background-color:cornflowerblue">
                        <h2>Bệnh nhân</h2>
                        <p id="patient"></p>
                    </div>
                    <div class="modal-body">
                        <table style="width:800px; margin:auto " border="1" align="left">
                            <tr class="modal-body">
                                <td style="font-weight:bold"> Triệu chứng</td>
                                <td id="symptom"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Khoa</td>
                                <td id="department"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Bác sĩ khám</td>
                                <td id="doctor"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Ngày đến khám</td>
                                <td id="dateMeet"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Thời gian khám</td>
                                <td id="timeMeet"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Chuẩn đoán</td>
                                <td id="diagnostic"></td>
                            </tr>
                            <tr>
                                <td style="font-weight:bold">Trị liệu</td>
                                <td id="therapyRegiment"></td>
                            </tr>
                        </table>

                    </div>

                    <div id="project-modal">
                        <div id="fieldGroupModal">
                            <div>
                                <div>

                                    @*hien thi ds test*@
                                    <div class="col-md-12">
                                        <div class="form" style="width:100%">
                                            <div class="col-md-12" style="padding:0px">
                                                <div class="table-scrollable">
                                                    <table class="table table-striped table-bordered table-advance table-hover">
                                                        <thead>
                                                            <tr>
                                                                <td class="control-label bold margin-top-10">
                                                                    Loai Test
                                                                </td>
                                                                <td class="control-label bold margin-top-10">
                                                                    Bác sỹ làm xét nghiệm
                                                                </td>
                                                                <td class="control-label bold margin-top-10">
                                                                    Chuẩn Doán
                                                                </td>
                                                                <td class="control-label bold margin-top-10">
                                                                    file đính kèm
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                        </thead>
                                                        <tbody data-bind="foreach: $root.arrayListTest">
                                                            <tr>
                                                                <td data-bind="text:doctorTest.test.name"></td>
                                                                <td data-bind="text:doctorTest.lastName"></td>
                                                                <td data-bind="text:diagnostic"></td>
                                                                <td data-bind="text:urlFile"></td>
                                                                <td>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="clear:left">
                        <div style="float:left;display:flex">
                            <input name="" type="checkbox" id="status" style="font-weight:bold; margin-right:10px" />
                            <span>Xác nhận gửi cho bệnh nhân</span>
                        </div>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                        <button type="button" class="btn btn-primary" data-bind="click:$root.save">Lưu</button>
                    </div>

                </div>
            </div>
        </div>
        @section Scripts {

            <script src="~/JsDoctor/ListPatient.js"></script>
        }
    }

</div>
